# 第一章 云原生应用和微服务简介

## 云计算简介

> 云计算服务可划分为以下几种类型:

* SaaS: Software as a Serivce，软件即服务。提供给终端用户可以直接食用的应用程序。
* PaaS: Platform as a Service，平台即服务。提供给终端用户工具和服务的集合，对想要快速构建应用程序或要快速将应用程序部署到生产环境，而不关心底层硬件细节的用户提供服务。
* IaaS: Infrastructure as a Service，设施设施即服务。针对想要建立自己的商业模式，而且需要定制的客户提供服务。

> 云计算，作为一个技术栈，可以这样解释:

* 通常谈及云计算指代的是一个技术栈，涵盖广泛的服务，其中很多服务都是建立在其他服务基础之上的，例如云
* 云计算模式被认为是不同的可配置的计算资源的集合\(如服务器、数据库和存储等等\)，它们之间互相通信，几乎可以在无需人为监督的情况下提供给用户。

### 软件即服务

> SaaS 要点

* SaaS 使用户能够通过浏览器访问由提供商提供的，基于互联网提供服务的软件。这些服务是订阅式的，也称为按需软件。
* 提供 Saas 的产品包括: Google Docs 套件、Oracle CRM、微软 Office 365 等等。
* SaaS 可以进一步细分为垂直 SaaS 和水平 SaaS。前者侧重于医疗保健和农业等特定行业的需求；后者专注于软件行业，例如人力资源和销售。
* SaaS 基本上是针对那些想要快速获取现成软件和应用的组织，这些应用即便是非技术人员也能理解和使用。通常，组织可以根据用途和预算选择不同的套餐。此外，终端用户也可以从任何可以连接到互联网的角落，访问这些应用。

### 平台即服务

> PaaS 要点

* 对于 PaSs 产品，组织或企业无需担心其内部应用程序的硬件和软件基础设施的管理问题。
* PaaS 的最大长处在于可以为开发团队\(本地或是远程\)提供在通用框架下，提供有效构建、测试和部署应用程序的能力，其中底层硬件和软件有 PaaS 服务供应商提供。
* PaaS 供应商提供平台，同时提供围绕该平台的服务。
* PaaS 供应商包括 Amazon Web Servies\(AWS Elastic Beanstalk\)、微软 Azure\(Azure Websites\)、Google App Engine 和 Oracle\(Big Data Cloud Service\)

## 云原生的概念

> 云原生是一种团队、文化和技术组织形式，利用自动化工具和架构来管理软件复杂度和加速软件交付。
>
> * **结果导向和团队合作**: 云原生的方法将一个大问题分解成众多的小问题，从而使每个团队都能专注于各自的部分。
>
> * **减少重复工作**: 自动化减少了困难、繁杂和重复的手动工作量，并减少了停机时间，这将使得系统更有效率。
>
> * **可靠而高效的应用程序基础设施**: 自动化可以对不同环境\(无论是开发、阶段发布还是生产\)中的部署做更多地控制，还可以处理意外事故。自动化构建不仅有助于正常部署，而且在灾难恢复时，也可以使重新部署更容易。
>
> * **应用程序洞察**: 为云原生应用程序构建的工具可以为应用程序提供更多洞察，从而使调试、故障排查和审计更容易。
>
> * **高效可靠的安全性**: 每个应用程序都会关注安全性，确保可靠的身份验证。孕育安盛为开发人员提供了多种确保应用程序安全性的方式。
>
> * **经济高效的系统**: 使用云管理和部署应用程序可以有效地利用资源，包括应用程序发布，通过减少资源浪费使系统花费更合理。

### 云原生为何物？为何重要？

> 云原生是一个宽泛的术语，它可以充分利用不同的技术，如基础架构自动化或中间件开发、支持服务等，这些功能都是属于应用交付周期的的一部分。云原生方法包括频繁的版本发布\(无Bug、稳定\)，以及根据业务需求扩展应用程序。
>
> 使用云原生方法，可以系统的实现应用程序构建目标。理想的云原生架构应具有自动化和组合功能，这些自动化技术还应实现跨平台管理和部署应用程序。
>
> 云原生架构还应该具有其他几个特性，如稳定的日志记录、应用程序和基础架构监控，以确保应用程序正常运行。
>
> 云原生方法能够帮助开发人员使用例如 Docker 等工具，在不同的平台上轻易地创建和销毁应用程序。

### 云原生运行时环境

> 当软件从一个计算环境迁移到另一个计算环境时，该如何使其可靠运行？最佳解决方案就是使用容器，Kubernetes 已经成为容器服务的代名词。
>
> 在容器运行时，需要注意以下几点:
>
> * **管理容器状态和高可用性**: 保持容器状态的同时，还因该能够业务需求进行扩展。
> * **成本体现和分析**: 容器可以根据业务预算控制资源管理，并在很大程度上降低成本。
> * **环境隔离**: 在容器内运行的每个进程都被隔离在该容器中。
> * **跨集群的负载均衡**: 应用流量由容器集群处理，在容器内均匀重定向，这将增加应用程序最大相应数量，并维持高可用性
> * **调试和灾难恢复**: 要有正确的工具用以监控应用程序运行状况，以避免生产系统意外停机，提高生产系统可用性。

### 云原生架构

> 云原生架构类似于传统应用架构，但在云原生架构下，应该考虑一些特性，如十二要素应用程序\(应用程序开发模式的集合\)、微服务\(将单体业务系统分解为独立可部署服务\)、自服务敏捷基础设施\(自服务平台\)、基于 API 的协作\(通过 API 进行服务之间的交互\)和抗脆弱性\(自我实现和加强的应用程序\)。
>
> 首先，探讨下什么是**微服务**。微服务是一个更宽泛的术语，指将大型应用程序分解成更小的模块，分别开发，直至发布。这种方法不仅有助于有效的管理每个模块，而且还可以帮助我们发现服务底层本身的问题。以下是为服务的一些关键部分:
>
> * **用户友好的界面**: 微服务之间可以实现明确的分离。微服务的版本控制可以更好地对 API 进行控制，为消费者和生产者提供更大的自由度。
> * **跨平台部署和 API 管理**: 由于每个微服务都是一个单独的实体，因此可以更新单个微服务而不用更改其他服务，同时也可以轻易实现服务回滚。这意味着用来部署微服务的工件应该兼容不同的 API 和数据模式。这些 API 必须在不同的平台上测试，并且测试结果应该在不同的团队，即运维、开发人员之间共享，大家共同维护一个集中的控制系统。
> * **应用灵活性**: 开发的微服务应该能够处理所有请求并做出响应，而不管请求的种类如何，包括可能的错误输入或无效请求。微服务也应该能够处理意外的负载请求，并进行适当的响应。所以，应当对未服务进行独立测试和集成测试。
> * **微服务的分布**: 最好将服务分为小块服务，以便单独跟踪和开发，最终组合起来形成一个微服务。这种技术使得微服务开发更稳定、更有效率。
>
> 下图展示了一个云原生应用程序的高级架构:



